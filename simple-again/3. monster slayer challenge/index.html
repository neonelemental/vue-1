<!DOCTYPE html>
<html>

<head>
    <title>Monster Slayer</title>
    <script src="https://npmcdn.com/vue/dist/vue.js"></script>
    <link rel="stylesheet" href="css/foundation.min.css">
    <link rel="stylesheet" href="css/app.css">
</head>
<style>
    .healthbar .healthbar {
        background-color: green;
        margin: 0;
        color: white;
    }
</style>

<body>
    <div id="app">
        <section class="row">
            <div class="small-6 columns">
                <h1 class="text-center">YOU</h1>
                <div class="healthbar">
                    <div class="healthbar text-center" :style="{width: userHealth + '%'}"></div>
                </div>
            </div>
            <div class="small-6 columns">
                <h1 class="text-center">MONSTER</h1>
                <div class="healthbar">
                    <div class="healthbar text-center" :style="{width: monsterHealth + '%'}"></div>
                </div>
            </div>
        </section>
        <section class="row controls" v-if="!isRunning">
            <div class="small-12 columns">
                <button id="start-game" @click="isRunning = !isRunning">START NEW GAME</button>
            </div>
        </section>
        <section class="row controls" v-else>
            <div class="small-12 columns">
                <button @click="attack" id="attack">ATTACK</button>
                <button @click="specialAttack" id="special-attack">SPECIAL ATTACK</button>
                <button @click="heal" id="heal">HEAL</button>
                <button @click="giveUp" id="give-up">GIVE UP</button>
            </div>
        </section>
        <section class="row log">
            <div class="small-12 columns">
                <ul>
                    <li v-for="entry in log">{{entry}}</li>
                </ul>
            </div>
        </section>
    </div>
    <script>
        new Vue({
            el: "#app",
            data() {
                return {
                    isRunning: false,
                    userHealth: 100,
                    monsterHealth: 100,
                    userDamage: 0,
                    monsterDamage: 0,
                    playerHealing: 20,
                    log: []
                }
            },
            methods: {
                attack() {
                    this.userAttacks(20);
                    this.monsterAttacks(20);
                    this.logDamage();
                    this.checkWinner();
                },
                specialAttack() {
                    this.userAttacks(30);
                    this.monsterAttacks(30);
                    this.logDamage();
                    this.checkWinner();
                },
                heal() {
                    this.userHealth += 20;
                    this.monsterAttacks(20);
                    this.logHealing();
                    this.checkWinner();
                },
                userAttacks(num) {
                    let damage = Math.round(Math.random() * num);
                    this.userDamage = damage;
                    this.monsterHealth -= damage;
                },
                monsterAttacks(num) {
                    let damage = Math.round(Math.random() * num);
                    this.monsterDamage = damage;
                    this.userHealth -= damage;
                },
                logHealing() {
                    this.log.push(
                        `player heals for ${this.playerHealing} health. monster hits for ${this.monsterDamage} damage.`
                    )
                },
                logDamage() {
                    this.log.push(
                        `monster attacks for ${this.monsterDamage} damage. user attacks for ${this.userDamage}`
                    )
                },
                giveUp() {
                    this.isRunning = false;
                    this.userHealth = 100;
                    this.monsterHealth = 100;
                    this.log = [];
                },
                checkWinner() {
                    if (this.userHealth <= 0) {
                        this.userHealth = 0;
                        if (window.confirm("you're fuckin dead mate! try again?")) {
                            this.giveUp();
                        } else {
                            return
                        }
                    }
                    if (this.userHealth >= 100) {
                        this.userHealth = 100;
                    }
                    if (this.monsterHealth <= 0) {
                        this.monsterHealth = 0;
                        if (window.confirm("you slayed it mate! try again?")) {
                            this.giveUp();
                        } else {
                            return
                        }
                    }
                }
            }
        })
    </script>
</body>

</html>